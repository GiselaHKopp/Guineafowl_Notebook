"0","# Community detection (by optimizing modularity over partitions):"
"0","clp <- cluster_optimal(net.sp)"
"0","class(clp)"
"1","[1]"
"1"," ""communities"""
"1","
"
"0","V(net.sp)$community <- clp$membership"
"0",""
"0","V(net.sp)$community2 <- case_when(V(net.sp)$community == ""3"" ~ Ten_colors[1],"
"0","                                V(net.sp)$community == ""4"" ~ Ten_colors[3],"
"0","                                V(net.sp)$community == ""2"" ~ Ten_colors[7],"
"0","                                V(net.sp)$community == ""1"" ~ Ten_colors[2],"
"0","                                V(net.sp)$community == ""5"" ~ Ten_colors[10],"
"0","                                V(net.sp)$community == ""6"" ~ Ten_colors[9],"
"0","                                V(net.sp)$community == ""7"" ~ ""brown"")"
"0",""
"0",""
"0","ggraph(net.sp, layout = ""stress"",bbox = 50) + "
"0","  "
"0","  geom_edge_link(aes(width = weight), alpha = 0.2) + "
"0","  scale_edge_width(range = c(0, 3)) +"
"0","  geom_node_point(color=V(net.sp)$community2, shape = V(net.sp)$shape, size= 5) +"
"0","  geom_node_point(color=V(net.sp)$color, shape = V(net.sp)$shape, size= 3) +"
"0","  geom_node_text(aes(filter = (label == ""  ""), label = label, size = degree(net.sp))) +"
"0","  labs(edge_width = ""rab"", color = ""Group_ID"", shape = ""sex"") +"
"0","  theme_graph()+"
"0","  theme(legend.position = ""bottom"") "
"0",""
